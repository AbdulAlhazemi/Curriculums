## 💻 الوحدة 2: إدارة النظام المتقدمة وسطر الأوامر

### 📘 الدرس 9: إدارة العمليات (Process Management)

#### 🧠 **ماذا ستتعلم**
* ما هي العملية (Process) ومعرف العملية (PID).
* كيفية عرض العمليات قيد التشغيل باستخدام `ps`.
* كيفية مراقبة العمليات في الوقت الفعلي باستخدام `top`.
* كيفية إنهاء عملية باستخدام `kill`.
* مقدمة في إدارة مهام الواجهة والخلفية (`bg`, `fg`).

---
### ⚙️ 1. ما هي العملية (Process)؟
العملية هي ببساطة **برنامج قيد التشغيل**. كل تطبيق أو أمر أو خدمة تعمل على حاسوبك هي عملية. يقوم نظام التشغيل بإعطاء كل عملية رقمًا فريدًا يسمى **معرف العملية (Process ID أو PID)**. نستخدم هذا الـ PID لإدارة عملية معينة، مثل إيقافها.

> **ببساطة:** إذا كان البرنامج هو "وصفة الطبخ"، فإن العملية هي "الشيف الذي يطبق هذه الوصفة حاليًا"، والـ PID هو "رقم الطلب" الخاص بهذا الطبق.

---
### 📋 2. عرض العمليات الحالية - الأمر `ps`
الأمر `ps` (اختصار لـ **P**rocess **S**tatus) يأخذ "لقطة شاشة" للعمليات قيد التشغيل في لحظة تنفيذه. استخدامه بدون خيارات ليس مفيدًا جدًا، لذا نستخدمه دائمًا مع خيارات.

**الشكل الأكثر شيوعًا هو `ps aux`:**
* `a`: يعرض العمليات لجميع المستخدمين.
* `u`: يعرضها بصيغة موجهة للمستخدم (تظهر اسم المالك، استخدام المعالج، إلخ).
* `x`: يعرض العمليات التي لا ترتبط بطرفية (مثل الخدمات التي تعمل في الخلفية).

**مثال:**
```bash
ps aux
```
**الناتج المتوقع (مختصر):**
```
USER         PID %CPU %MEM  COMMAND
root           1  0.0  0.1  /sbin/init
jameel      1234  0.5  2.5  firefox
jameel      5678  0.0  0.5  gnome-terminal
```
من هنا، يمكنك رؤية `PID` لكل عملية.

---
### 📊 3. مراقبة العمليات في الوقت الفعلي - الأمر `top`
الأمر `top` يشبه "مدير المهام" (Task Manager) في أنظمة ويندوز أو macOS، ولكنه يعمل داخل الطرفية. هو يعرض لك قائمة حية ومستمرة التحديث بالعمليات الأكثر استهلاكًا لموارد النظام.

**كيفية الاستخدام:** فقط اكتب `top` في الطرفية.
* تعرض القائمة بشكل افتراضي العمليات مرتبة حسب استهلاكها للمعالج (`%CPU`).
* يعرض الجزء العلوي ملخصًا لحالة النظام (استخدام المعالج، الذاكرة، إلخ).
* للخروج من `top`، اضغط على مفتاح `q`.

---
### 🛑 4. إيقاف العمليات - الأمر `kill`
الأمر `kill` يستخدم لإرسال "إشارة" إلى عملية ما، وعادة ما تكون هذه الإشارة لإنهاء العملية. لإيقاف عملية، يجب أن تعرف الـ `PID` الخاص بها أولاً (يمكنك الحصول عليه من `ps` أو `top`).

**الصيغة العامة:** `kill [PID]`

**هناك نوعان رئيسيان من إشارات الإنهاء:**

1.  **`SIGTERM` (رقم 15):** هذه هي الإشارة الافتراضية. إنها طلب "مهذب" للعملية بأن تغلق نفسها بشكل نظيف.
    ```bash
    # هذا الأمر يرسل إشارة SIGTERM إلى العملية 1234
    kill 1234
    ```
2.  **`SIGKILL` (رقم 9):** هذه هي إشارة "القتل الفوري". تقوم بإنهاء العملية فورًا دون إعطائها فرصة لحفظ عملها. استخدمها فقط إذا لم تستجب العملية للإشارة الأولى.
    ```bash
    # يجب تحديد رقم الإشارة باستخدام -9
    kill -9 5678
    ```
> **نصيحة هامة:** دائمًا جرب `kill [PID]` أولاً. إذا لم تتوقف العملية، استخدم `kill -9 [PID]` كملاذ أخير.

---
### 🏃 5. إدارة مهام الواجهة والخلفية
في بعض الأحيان، قد ترغب في تشغيل أمر يستغرق وقتًا طويلاً دون أن يعطل طرفيتك.
* **`&`:** لإضافة `&` في نهاية الأمر يقوم بتشغيله في **الخلفية (background)** مباشرة.
    ```bash
    # سيتم تشغيل هذا الأمر في الخلفية، ويمكنك مواصلة استخدام الطرفية
    sleep 300 &
    ```
* **`Ctrl + Z`:** يوقف العملية الحالية في **الواجهة (foreground)** وينقلها إلى الخلفية (لكنها متوقفة).
* **`jobs`:** يعرض قائمة بالمهام التي تعمل في الخلفية.
* **`fg` (foreground):** يجلب مهمة من الخلفية إلى الواجهة. (مثال: `fg %1`).
* **`bg` (background):** يستأنف تشغيل مهمة متوقفة في الخلفية. (مثال: `bg %1`).

---