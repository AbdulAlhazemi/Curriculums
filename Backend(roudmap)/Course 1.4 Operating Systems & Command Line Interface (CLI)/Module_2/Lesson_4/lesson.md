## 💻 الوحدة 2: إدارة النظام المتقدمة وسطر الأوامر

### 📘 الدرس 10: إعادة التوجيه والأنابيب (Redirection and Piping)

#### 🧠 **ماذا ستتعلم**
* فهم التدفقات القياسية: الإدخال (stdin)، الإخراج (stdout)، والخطأ (stderr).
* كيفية إعادة توجيه مخرجات أمر إلى ملف (`>` و `>>`).
* كيفية استخدام ملف كمدخل لأمر (`<`).
* كيفية ربط الأوامر معًا باستخدام الأنابيب (`|`) لإنشاء سلاسل أوامر قوية.

---
### 🌊 1. التدفقات القياسية (Standard Streams)
في بيئة لينكس، كل برنامج يعمل في الطرفية يمتلك ثلاثة تدفقات بيانات قياسية:
1.  **Standard Input (stdin):** المدخلات التي يستقبلها البرنامج. افتراضيًا، تكون من لوحة المفاتيح.
2.  **Standard Output (stdout):** المخرجات العادية للبرنامج. افتراضيًا، تُعرض على الشاشة.
3.  **Standard Error (stderr):** مخرجات الأخطاء. افتراضيًا، تُعرض أيضًا على الشاشة.

إعادة التوجيه والأنابيب هي تقنيات للتحكم في هذه التدفقات.

---
### 🚰 2. إعادة توجيه المخرجات (Output Redirection)
تسمح لك بحفظ المخرجات التي تظهر على الشاشة في ملف بدلاً من ذلك.

* **`>` (Overwrite - الكتابة فوق الملف):**
    يأخذ المخرجات من الأمر ويكتبها في ملف. **إذا كان الملف موجودًا، فسيتم حذف محتواه القديم.** إذا لم يكن موجودًا، فسيتم إنشاؤه.
    ```bash
    # حفظ قائمة مفصلة بالملفات في ملف اسمه 'file_list.txt'
    ls -l > file_list.txt
    ```

* **`>>` (Append - الإضافة إلى نهاية الملف):**
    يأخذ المخرجات ويضيفها إلى **نهاية** الملف دون حذف محتواه الحالي.
    ```bash
    # إضافة التاريخ والوقت الحاليين إلى نهاية ملف السجل
    date >> activity.log
    ```

> **نصيحة:** يمكنك أيضًا إعادة توجيه الأخطاء باستخدام `2>`. على سبيل المثال، `bad_command 2> errors.txt` سيحفظ رسالة الخطأ في ملف `errors.txt` بدلاً من عرضها على الشاشة.

---
### 📥 3. إعادة توجيه المدخلات (Input Redirection)
تسمح لك باستخدام محتوى ملف كمدخل لأمر، بدلاً من كتابته يدويًا. هذا أقل شيوعًا من إعادة توجيه المخرجات، لكنه مفيد.

**مثال:** الأمر `sort` يقوم بفرز الأسطر. يمكنك إعطاؤه ملفًا كمدخل.
```bash
# لنفترض أن لديك ملف 'names.txt' يحتوي على أسماء غير مرتبة
# سيقوم الأمر التالي بفرزها وعرضها على الشاشة
sort < names.txt
```

---
### 🔗 4. الأنابيب (Piping) - قوة سطر الأوامر
الأنابيب، التي يرمز لها بالخط العمودي `|`، هي من أقوى ميزات الصدفة. تسمح لك بأخذ **مخرجات (stdout)** أمر ما واستخدامها مباشرة كـ **مدخلات (stdin)** لأمر آخر. هذا يمكنك من بناء سلاسل معقدة من الأوامر البسيطة.

> **ببساطة:** تخيلها كأنبوب مياه يربط مخرج آلة بمدخل آلة أخرى.

**أمثلة كلاسيكية:**

* **البحث عن عملية معينة:**
    ```bash
    # ps aux يعرض كل العمليات
    # | يأخذ هذه القائمة الطويلة
    # grep firefox يبحث في القائمة عن السطر الذي يحتوي على "firefox"
    ps aux | grep "firefox"
    ```

* **عد الأسطر التي تحتوي على كلمة معينة:**
    ```bash
    # cat يقرأ الملف
    # grep يرشح الأسطر التي تحتوي على "ERROR"
    # wc -l يعد عدد الأسطر المتبقية
    cat server.log | grep "ERROR" | wc -l
    ```
---
