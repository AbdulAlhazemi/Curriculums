## 🧪 الوحدة 3: استراتيجيات ومقاييس الاختبار

### 📘 الدرس 10: التطوير الموجه بالسلوك (BDD)

#### 🧠 **ماذا ستتعلم**
* ما هو التطوير الموجه بالسلوك (Behavior-Driven Development - BDD).
* كيف يعتبر BDD امتدادًا لـ TDD.
* صيغة "Given-When-Then" المستخدمة لكتابة سيناريوهات BDD.
* فوائد BDD في تحسين التعاون بين أعضاء الفريق.

---
### 🤔 1. ما هو التطوير الموجه بالسلوك؟
التطوير الموجه بالسلوك (BDD) هو عملية تطوير برمجيات تطورت من التطوير الموجه بالاختبار (TDD). لكن بينما تركز TDD على كتابة الاختبارات من منظور المطور (هل الدالة تعمل بشكل صحيح؟)، فإن BDD تركز على **وصف واختبار سلوك النظام من منظور المستخدم أو صاحب المصلحة (stakeholder)**.

إنها منهجية تشجع على **التعاون** بين المطورين، مختبري الجودة (QA)، والمشاركين غير التقنيين (مثل مديري المنتجات) لإنشاء فهم مشترك لكيفية عمل الميزة المطلوبة.

> **ببساطة:**
> * **TDD** يشبه فنيًا يختبر الدوائر الكهربائية في منزلك ليتأكد من أن الجهد الكهربائي صحيح. (تقني جدًا).
> * **BDD** يشبه صاحب المنزل الذي يصف السلوك المطلوب: "**عندما** أضغط على هذا المفتاح، **إذًا** يجب أن يضيء المصباح في غرفة المعيشة". (يركز على السلوك الملحوظ).

---
### 📝 2. صيغة Gherkin: Given, When, Then
تتم كتابة سيناريوهات BDD عادةً بلغة شبه طبيعية ومنظمة تسمى **Gherkin**. تستخدم هذه اللغة كلمات مفتاحية محددة لوصف سلوك النظام.

* **`Given` (بافتراض):** تصف السياق الأولي أو الحالة الابتدائية للنظام قبل بدء الإجراء. (هذا هو جزء `Arrange` في نمط AAA).
* **`When` (عندما):** تصف الإجراء أو الحدث الذي يقوم به المستخدم. (هذا هو جزء `Act`).
* **`Then` (إذًا):** تصف النتيجة المتوقعة أو المخرج. (هذا هو جزء `Assert`).
* **`And` / `But` (و / لكن):** يمكن استخدامها لتوسيع أي من الخطوات السابقة.

**مثال: سيناريو تسجيل الدخول**
```gherkin
Feature: User Login

  Scenario: Successful login with valid credentials
    Given I am a guest user on the login page
    And I have entered my correct username and password
    When I click the "Login" button
    Then I should be redirected to my dashboard page
    And I should see a "Welcome back, Jameel!" message
```
لاحظ كيف أن هذا السيناريو مفهوم تمامًا لأي شخص في الفريق، سواء كان تقنيًا أم لا.

---
### ⚙️ 3. كيف يعمل BDD عمليًا؟
1.  **المحادثة:** يجتمع الفريق (مدير المنتج، المطور، QA) لمناقشة ميزة جديدة وكتابة السيناريوهات الخاصة بها بصيغة Gherkin.
2.  **تعريف الخطوات:** يقوم المطور بعد ذلك بكتابة "تعريفات الخطوات" (Step Definitions)، وهي دوال جافاسكريبت ترتبط بكل سطر من سيناريو Gherkin. على سبيل المثال، السطر `When I click the "Login" button` سيتم ربطه بدالة تقوم بمحاكاة النقر على الزر.
3.  **التنفيذ:** يستخدم المطور دورة TDD (أحمر-أخضر-إعادة هيكلة) لكتابة الكود الفعلي الذي يجعل تعريفات الخطوات هذه تنجح، وبالتالي ينجح السيناريو بأكمله.

**أشهر الأدوات:**
* **Cucumber:** هو إطار العمل الأكثر شهرة لتطبيق BDD، ويعمل مع العديد من اللغات بما في ذلك جافاسكريبت (`cucumber-js`).
* **Jest Plugins:** توجد إضافات لـ Jest (مثل `jest-cucumber`) تسمح بكتابة الاختبارات بنفس صيغة BDD.

---
### ⭐ 4. فوائد منهجية BDD
* **تحسين التواصل:** تنشئ لغة مشتركة وفهمًا موحدًا بين جميع أعضاء الفريق، التقنيين وغير التقنيين.
* **التركيز على قيمة العمل:** تضمن أن جهود التطوير مرتبطة مباشرة بالنتائج والسلوكيات التجارية المرغوبة.
* **توثيق حي:** تعمل ملفات السيناريوهات كتوثيق محدث وقابل للتنفيذ لكيفية عمل النظام.
* **تقليل الغموض:** الصيغة المنظمة توضح المتطلبات وتقلل من سوء الفهم بين أعضاء الفريق.

---
