## โ๏ธ ุงููุญุฏุฉ 2: ุงูุชุทุจูู ุงูุนููู ุจุงุณุชุฎุฏุงู GitHub Actions

### ๐ ุงูุฏุฑุณ 3: ุฅูุดุงุก ุฎุท ุฃูุงุจูุจ CD ุฃุณุงุณู (ููุงูููููุง)

#### ๐ง **ูุงุฐุง ุณุชุชุนูู**
* ุงููุฏู ูู ุฎุท ุฃูุงุจูุจ ุงููุดุฑ ุงููุณุชูุฑ (CD).
* ููููุฉ ููููุฉ ุณูุฑ ุนูู ูุญุชูู ุนูู ููุงู ูุชุนุฏุฏุฉ ููุนุชูุฏุฉ ุนูู ุจุนุถูุง (`test` ู `deploy`).
* ููููุฉ ุงุณุชุฎุฏุงู `needs` ูุฅูุดุงุก ุชุจุนูุงุช ุจูู ุงูููุงู.
* ููููุฉ ุงุณุชุฎุฏุงู ุงูุดุฑูุท `if` ูุชุดุบูู ูููุฉ ุงููุดุฑ ุนูู ุงููุฑุน ุงูุฑุฆูุณู ููุท.
* ุงูุฎุทูุงุช ุงูููุงููููุฉ ูุนูููุฉ ูุดุฑ ุญููููุฉ (SSH, git pull, pm2).

---
### ๐ค 1. ูู ุงูุชูุงูู ุงููุณุชูุฑ ุฅูู ุงููุดุฑ ุงููุณุชูุฑ
ูู ุงูุฏุฑุณ ุงูุณุงุจูุ ูููุง ุจุจูุงุก ุฎุท ุฃูุงุจูุจ ููุชูุงูู ุงููุณุชูุฑ (CI). ูุธููุชู ูู ุงูุชุฃูุฏ ูู ุฃู ุงูููุฏ ูู ูุฑุนูุง ุงูุฑุฆูุณู ูุชู ุจูุงุคู ูุงุฎุชุจุงุฑู ุจูุฌุงุญ ุฏุงุฆููุง. ูุฐุง ูุชุฑููุง ูุน ูุณุฎุฉ "ุฌูุฏุฉ" ูู ุงูููุฏ ุฌุงูุฒุฉ ููุฅุตุฏุงุฑ.

**ุงูุฎุทูุฉ ุงูุชุงููุฉ:** ุงูุขูุ ูุฑูุฏ ุฃู ูุฃุฎุฐ ูุฐุง ุงูููุฏ ุงูุฐู ูุฌุญ ูู ุงูุงุฎุชุจุงุฑุงุช ู**ููุดุฑู ุชููุงุฆููุง** ุนูู ุฎุงุฏููุง ููุตุจุญ ูุชุงุญูุง ูููุณุชุฎุฏููู. ูุฐู ูู ูุธููุฉ ุงููุดุฑ ุงููุณุชูุฑ (CD).

---
### ๐๏ธ 2. ููููุฉ ุณูุฑ ุนูู ุงููุดุฑ ุงููุณุชูุฑ
ุนุงุฏุฉูุ ูุชููู ุฎุท ุฃูุงุจูุจ CD ูู ูููุชูู ุฑุฆูุณูุชูู ุฃู ุฃูุซุฑ ุชุนูู ุจุงูุชุณูุณู:
1.  **ูููุฉ ุงูุงุฎุชุจุงุฑ (`test`):** ุชููู ุจููุณ ูุง ูุนูู ุฎุท ุฃูุงุจูุจ CI: ุจูุงุก ุงูููุฏ ูุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช.
2.  **ูููุฉ ุงููุดุฑ (`deploy`):** ุชุนูู **ููุท ุฅุฐุง ูุฌุญุช ูููุฉ ุงูุงุฎุชุจุงุฑ**. ูู ูุณุคููุฉ ุนู ุฃุฎุฐ ุงูููุฏ ููุดุฑู ุนูู ุงูุฎุงุฏู.

#### **ุงููููุฉ ุงูููุชุงุญูุฉ `needs`**
ูุณุชุฎุฏู `needs` ูุฅูุดุงุก ุชุจุนูุฉ ุจูู ุงูููุงู. `needs: test` ุฏุงุฎู ูููุฉ `deploy` ุชุนูู ุฃู ูููุฉ `deploy` ูู ุชุจุฏุฃ ุฅูุง ุจุนุฏ ุงูุชูุงู ูููุฉ `test` ุจูุฌุงุญ.

#### **ุงูุดุฑุท `if`**
ูุฑูุฏ ุฃู ุชุชู ุนูููุฉ ุงููุดุฑ ููุท ุนูุฏ ุชุญุฏูุซ ุงููุฑุน ุงูุฑุฆูุณู (`main`)ุ ูููุณ ุนูุฏ ูู ุฏูุนุฉ (`push`) ุฅูู ุฃู ูุฑุน ุขุฎุฑ. ูุณุชุฎุฏู `if` ูุชุญููู ุฐูู.
`if: github.ref == 'refs/heads/main'`

---
### ๐ 3. ููู ุณูุฑ ุงูุนูู ุงููุงูู (ููุงูููููุง)
ูุฐุง ูุซุงู ุนูู ููู `cd.yml` ูุฌูุน ุจูู CI ู CD.

```yaml
name: CI/CD Pipeline

on:
  push:
    branches: [ main ]

jobs:
  # ุงููููุฉ ุงูุฃููู: ุจูุงุก ูุงุฎุชุจุงุฑ ุงูุชุทุจูู
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20.x'
      - run: npm ci
      - run: npm test

  # ุงููููุฉ ุงูุซุงููุฉ: ูุดุฑ ุงูุชุทุจูู
  deploy:
    runs-on: ubuntu-latest
    # ุงุฌุนู ูุฐู ุงููููุฉ ุชุนุชูุฏ ุนูู ูุฌุงุญ ูููุฉ 'test'
    needs: test
    # ุดุบู ูุฐู ุงููููุฉ ููุท ุนูุฏ ุงูุฏูุน ุฅูู ูุฑุน main
    if: github.ref == 'refs/heads/main'

    steps:
      - name: Deploy to production server
        # ูุฐู ุงูุฎุทูุฉ ููุงููููุฉ. ุงููุดุฑ ุงูุญูููู ูุชุทูุจ ููุงุชูุญ SSH ูุฃุณุฑุงุฑ.
        # ุณูุชุนูู ุนู ุงูุฃุณุฑุงุฑ ูู ุงูุฏุฑุณ ุงููุงุฏู.
        run: |
          echo "๐ Starting deployment..."
          echo "1. Connecting to server via SSH..."
          echo "2. Pulling latest changes from main branch..."
          echo "3. Installing production dependencies..."
          echo "4. Restarting the application with PM2..."
          echo "โ Deployment successful!"
```

---
### SSH 4. ููู ูุจุฏู ุงููุดุฑ ุงููุนููุ
ุงูุฎุทูุงุช ุงูุชู ุชู ุชุจุณูุทูุง ูู ุงููุซุงู ุฃุนูุงูุ ูู ุงูุนุงูู ุงูุญููููุ ุชุชู ุนุงุฏุฉู ูุงูุชุงูู ุจุงุณุชุฎุฏุงู ุฅุฌุฑุงุกุงุช (Actions) ุฌุงูุฒุฉ:
1.  **ุงูุงุชุตุงู ุจุงูุฎุงุฏู (SSH):** ูุชู ุงุณุชุฎุฏุงู Action (ูุซู `appleboy/ssh-action`) ูุน ููุงุชูุญ SSH ุงููุฎุฒูุฉ ูู "ุฃุณุฑุงุฑ" GitHub ููุงุชุตุงู ุจุงูุฎุงุฏู ุจุฃูุงู.
2.  **ุณุญุจ ุงูุชุบููุฑุงุช:** ูุชู ุชูููุฐ ุฃูุฑ `git pull` ุนูู ุงูุฎุงุฏู ูุฌูุจ ุฃุญุฏุซ ูุณุฎุฉ ูู ุงูููุฏ.
3.  **ุชุซุจูุช ุงูุชุจุนูุงุช:** ูุชู ุชูููุฐ `npm install --production` ูุชุซุจูุช ุงูุชุจุนูุงุช ุงูุถุฑูุฑูุฉ ููุฅูุชุงุฌ ููุท.
4.  **ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู:** ูุชู ุงุณุชุฎุฏุงู ูุฏูุฑ ุนูููุงุช ูุซู `pm2` ูุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู ุฏูู ุงููุทุงุน (`pm2 reload app`).

---
