## ðŸ”‘ Ø§Ù„ÙˆØ­Ø¯Ø© 3: Ù…ÙˆØ§Ø¶ÙŠØ¹ Ù…ØªÙ‚Ø¯Ù…Ø© ÙÙŠ Ø§Ù„Ø£Ù…Ø§Ù†

### ðŸ“˜ Ø§Ù„Ø¯Ø±Ø³ 2: Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± (RBAC)

#### ðŸ§  **Ù…Ø§Ø°Ø§ Ø³ØªØªØ¹Ù„Ù…**
* Ù…Ø§ Ù‡Ùˆ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± (Role-Based Access Control - RBAC).
* Ø¥Ø¹Ø§Ø¯Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªØ®ÙˆÙŠÙ„.
* ÙƒÙŠÙÙŠØ© ØªØµÙ…ÙŠÙ… Ù†Ø¸Ø§Ù… Ø£Ø¯ÙˆØ§Ø± Ø¨Ø³ÙŠØ· (Ù…Ø«Ù„ `user` Ù…Ù‚Ø§Ø¨Ù„ `admin`).
* ÙƒÙŠÙÙŠØ© ØªØ·Ø¨ÙŠÙ‚ Middleware Ù„Ù„ØªØ®ÙˆÙŠÙ„ ÙÙŠ Express Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†.

---
### ðŸ¤” 1. Ù…Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©: Ø§Ù„ØªØ®ÙˆÙŠÙ„
Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ØªØ¬ÙŠØ¨ Ø¹Ù„Ù‰ Ø³Ø¤Ø§Ù„ "Ù…Ù† Ø£Ù†ØªØŸ". Ù„ÙƒÙ† Ø¨Ù…Ø¬Ø±Ø¯ Ø£Ù† Ù†Ø¹Ø±Ù Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ùˆ "Ø£Ø­Ù…Ø¯"ØŒ Ù‡Ø°Ø§ Ù„Ø§ ÙŠØ®Ø¨Ø±Ù†Ø§ Ø¨Ø£ÙŠ Ø´ÙŠØ¡ Ø¹Ù† ØµÙ„Ø§Ø­ÙŠØ§ØªÙ‡. Ù‡Ù„ "Ø£Ø­Ù…Ø¯" Ù…Ø¬Ø±Ø¯ Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ Ø£Ù… Ù‡Ùˆ Ù…Ø¯ÙŠØ± Ù„Ù„Ù†Ø¸Ø§Ù…ØŸ

Ù‡Ù†Ø§ ÙŠØ£ØªÙŠ Ø¯ÙˆØ± **Ø§Ù„ØªØ®ÙˆÙŠÙ„ (Authorization)**ØŒ Ø§Ù„Ø°ÙŠ ÙŠØ¬ÙŠØ¨ Ø¹Ù„Ù‰ Ø³Ø¤Ø§Ù„ "Ù…Ø§Ø°Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø£Ù† ØªÙØ¹Ù„ØŸ". **RBAC** Ù‡Ùˆ Ø£Ø­Ø¯ Ø£Ø´Ù‡Ø± ÙˆØ£Ø¨Ø³Ø· Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ®ÙˆÙŠÙ„.

**Ø§Ù„ÙÙƒØ±Ø©:** Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ØªØ¹ÙŠÙŠÙ† ØµÙ„Ø§Ø­ÙŠØ§Øª Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù„Ù‰ Ø­Ø¯Ø© (ÙˆÙ‡Ùˆ Ø£Ù…Ø± Ù…Ø¹Ù‚Ø¯ Ø¬Ø¯Ù‹Ø§)ØŒ Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ù†Ø´Ø§Ø¡ "Ø£Ø¯ÙˆØ§Ø±" (Roles) Ù…Ø«Ù„ `admin`, `editor`, `viewer`. Ù†Ø¹Ø·ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±ØŒ Ø«Ù… Ù†Ø¹ÙŠÙ† Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†.

> **Ø¨Ø¨Ø³Ø§Ø·Ø©:** ÙÙŠ Ø´Ø±ÙƒØ©ØŒ Ù„Ø§ ÙŠØªÙ… Ø¥Ø¹Ø·Ø§Ø¡ ÙƒÙ„ Ù…ÙˆØ¸Ù Ù…ÙØªØ§Ø­Ù‹Ø§ Ù…Ø®ØµØµÙ‹Ø§ Ù„ÙƒÙ„ ØºØ±ÙØ© ÙŠØ­ØªØ§Ø¬Ù‡Ø§. Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„ÙƒØŒ Ù‡Ù†Ø§Ùƒ Ø£Ø¯ÙˆØ§Ø±: "Ù…Ø¯ÙŠØ±"ØŒ "Ù…Ø­Ø§Ø³Ø¨"ØŒ "Ù…ÙˆØ¸Ù". Ù…ÙØªØ§Ø­ "Ø§Ù„Ù…Ø¯ÙŠØ±" ÙŠÙØªØ­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨. Ù…ÙØªØ§Ø­ "Ø§Ù„Ù…Ø­Ø§Ø³Ø¨" ÙŠÙØªØ­ Ù…ÙƒØªØ¨ Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙÙ‚Ø·. Ø£Ù†Øª ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø°ÙŠ ÙŠÙ†Ø§Ø³Ø¨ Ø¯ÙˆØ±Ùƒ.

---
### âš™ï¸ 2. ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±ØŸ
1.  **ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±:** Ø­Ø¯Ø¯ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø®ØªÙ„ÙØ© ÙÙŠ ØªØ·Ø¨ÙŠÙ‚Ùƒ (Ù…Ø«Ù„Ø§Ù‹ `admin`, `member`).
2.  **ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª:** Ù„ÙƒÙ„ Ø¯ÙˆØ±ØŒ Ø­Ø¯Ø¯ Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§ (Ù…Ø«Ù„Ø§Ù‹ØŒ `admin` ÙŠÙ…ÙƒÙ†Ù‡ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŒ Ø¨ÙŠÙ†Ù…Ø§ `member` Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡ Ø°Ù„Ùƒ).
3.  **ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:** Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ØŒ ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† Ø¯ÙˆØ± Ù„Ù‡.
4.  **ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ø¯ÙˆØ± ÙÙŠ Ø§Ù„ØªÙˆÙƒÙ†:** Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ØªØ®ÙˆÙŠÙ„ Ø¹Ø¯ÙŠÙ… Ø§Ù„Ø­Ø§Ù„Ø©ØŒ ÙŠØ¬Ø¨ ØªØ¶Ù…ÙŠÙ† Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙƒØ¬Ø²Ø¡ Ù…Ù† Ø­Ù…ÙˆÙ„Ø© (Payload) ØªÙˆÙƒÙ† JWT Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡.
    ```json
    {
      "id": 123,
      "username": "jameel",
      "role": "admin"
    }
    ```
5.  **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¯ÙˆØ±:** Ø¹Ù†Ø¯ ÙƒÙ„ Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø± Ù…Ø­Ù…ÙŠØŒ ÙŠÙ‚ÙˆÙ… Middleware Ø®Ø§Øµ Ø¨Ø§Ù„ØªØ®ÙˆÙŠÙ„ Ø¨Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„ØªÙˆÙƒÙ† Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† ÙŠØ¬Ø¨ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ø£Ù… Ù„Ø§.

---
### ðŸ›¡ï¸ 3. ØªØ·Ø¨ÙŠÙ‚ RBAC ÙÙŠ Express
Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Middleware Ù„Ù„ØªØ®ÙˆÙŠÙ„ ÙŠÙƒÙˆÙ† Ù…Ø±Ù†Ù‹Ø§ Ø¨Ù…Ø§ ÙŠÙƒÙÙŠ Ù„ÙŠØ³Ù…Ø­ Ù„Ù†Ø§ Ø¨ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§ Ù„ÙƒÙ„ Ù…Ø³Ø§Ø±.

**Ø§Ù„Ù…ØªØ·Ù„Ø¨ Ø§Ù„Ø³Ø§Ø¨Ù‚:** Ù†ÙØªØ±Ø¶ Ø£Ù† Middleware Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (Ù…Ù† Ø§Ù„Ø¯Ø±Ø³ 7) Ù‚Ø¯ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡ Ø¨Ø§Ù„ÙØ¹Ù„ ÙˆØ£Ù†Ù‡ ÙŠØ¶ÙŠÙ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙÙƒÙƒØ© Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ† Ø¥Ù„Ù‰ `req.user`.

**Ù…Ø«Ø§Ù„: Middleware Ù„Ù„ØªØ®ÙˆÙŠÙ„ (`authorize.js`)**
Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© *ØªÙØ±Ø¬Ø¹* Ø¯Ø§Ù„Ø© Middleware. Ù‡Ø°Ø§ Ù†Ù…Ø· Ø´Ø§Ø¦Ø¹ Ù„Ø¬Ø¹Ù„ Ø§Ù„Ù€ Middleware Ù‚Ø§Ø¨Ù„Ø§Ù‹ Ù„Ù„ØªØ®ØµÙŠØµ.
```javascript
// Ù†Ù…Ø±Ø± Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§ ÙƒÙˆØ³ÙŠØ·Ø§Øª
const authorize = (...allowedRoles) => {
  return (req, res, next) => {
    // Ù†ÙØªØ±Ø¶ Ø£Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ØªÙ…Øª ÙˆØ£Ù† req.user Ù…ÙˆØ¬ÙˆØ¯
    const userRole = req.user.role;
    
    // Ù†ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¯Ø±Ø¬Ù‹Ø§ ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§
    if (allowedRoles.includes(userRole)) {
      next(); // Ù…Ø³Ù…ÙˆØ­ØŒ Ø§Ù†ØªÙ‚Ù„ Ù„Ù„ØªØ§Ù„ÙŠ
    } else {
      // ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ØŒ Ø£Ø±Ø³Ù„ Ø®Ø·Ø£ "Forbidden"
      res.status(403).json({ message: "Forbidden: You do not have the right permissions." });
    }
  };
};

module.exports = authorize;
```
**Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù€ Middleware Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª:**
```javascript
const authMiddleware = require('./authMiddleware'); // Middleware Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
const authorize = require('./authorize'); // Middleware Ø§Ù„ØªØ®ÙˆÙŠÙ„

// Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø± Ù…Ø­Ù…ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø°ÙŠÙ† Ù„Ø¯ÙŠÙ‡Ù… Ø¯ÙˆØ± 'admin' ÙÙ‚Ø·
app.delete('/api/users/:id', authMiddleware, authorize('admin'), (req, res) => {
  // ... Ù…Ù†Ø·Ù‚ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
});

// Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø± Ù…Ø­Ù…ÙŠ Ù„Ù„Ù…Ø¯Ø±Ø§Ø¡ ÙˆØ§Ù„Ù…Ø­Ø±Ø±ÙŠÙ†
app.put('/api/posts/:id', authMiddleware, authorize('admin', 'editor'), (req, res) => {
  // ... Ù…Ù†Ø·Ù‚ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„
});
```
---

