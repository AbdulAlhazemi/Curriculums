## ğŸ”‘ Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ† (Token-Based Authentication)

### ğŸ“˜ Ø§Ù„Ø¯Ø±Ø³ 3: ØªØ·Ø¨ÙŠÙ‚ JWT Ù…Ø¹ Node.js Ùˆ Express

#### ğŸ§  **Ù…Ø§Ø°Ø§ Ø³ØªØªØ¹Ù„Ù…**
* ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø­Ø²Ù…Ø© `jsonwebtoken` Ø§Ù„Ø´Ù‡ÙŠØ±Ø© ÙÙŠ Node.js.
* ÙƒÙŠÙÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ (ØªÙˆÙ‚ÙŠØ¹) ØªÙˆÙƒÙ† JWT Ø¬Ø¯ÙŠØ¯ Ø¹Ù†Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­.
* ÙƒÙŠÙÙŠØ© ÙƒØªØ§Ø¨Ø© Middleware Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ØªÙˆÙƒÙ† ÙÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙˆØ§Ø±Ø¯Ø©.
* ÙƒÙŠÙÙŠØ© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª (Routes) Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù€ Middleware.

---
### ğŸ§° 1. Ø§Ù„Ø£Ø¯Ø§Ø©: Ø­Ø²Ù…Ø© `jsonwebtoken`
Ù„Ø³Øª Ø¨Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ Ø¨Ù†Ø§Ø¡ Ù…Ù†Ø·Ù‚ JWT Ù…Ù† Ø§Ù„ØµÙØ±. Ø­Ø²Ù…Ø© `jsonwebtoken` Ù‡ÙŠ Ø§Ù„Ù…Ø¹ÙŠØ§Ø± Ø§Ù„ÙØ¹Ù„ÙŠ ÙÙŠ Ø¨ÙŠØ¦Ø© Node.js Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ JWTs Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ£Ù…Ø§Ù†.

**Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø§Ù„ØªØ«Ø¨ÙŠØª**
ÙÙŠ Ù…Ø´Ø±ÙˆØ¹ Express Ø§Ù„Ø®Ø§Øµ Ø¨ÙƒØŒ Ù‚Ù… Ø¨ØªØ«Ø¨ÙŠØª Ø§Ù„Ø­Ø²Ù…Ø©:
```bash
npm install jsonwebtoken
```

---
### âœï¸ 2. Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªÙˆÙ‚ÙŠØ¹ Ø§Ù„ØªÙˆÙƒÙ† (Ø¹Ù†Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„)
ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙˆÙƒÙ† Ø¨Ø¹Ø¯ Ø£Ù† ÙŠØªØ­Ù‚Ù‚ Ø§Ù„Ø®Ø§Ø¯Ù… Ù…Ù† ØµØ­Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù…Ø«Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±). Ù†Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ù„Ø© `jwt.sign()` Ù„Ù‡Ø°Ø§ Ø§Ù„ØºØ±Ø¶.

* **Ø¯Ø§Ù„Ø© `jwt.sign(payload, secretKey, options)`:**
    * `payload`: ÙƒØ§Ø¦Ù† Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ ÙˆØ¶Ø¹Ù‡Ø§ ÙÙŠ Ø§Ù„ØªÙˆÙƒÙ† (Ù…Ø«Ù„ `userId`).
    * `secretKey`: Ù…ÙØªØ§Ø­ Ø³Ø±ÙŠ Ù„Ø§ ÙŠØ¹Ø±ÙÙ‡ Ø£Ø­Ø¯ Ø³ÙˆÙ‰ Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ³ØªØ®Ø¯Ù… Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„ØªÙˆÙƒÙ†. **ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…Ø¹Ù‚Ø¯Ù‹Ø§ ÙˆÙŠØªÙ… ØªØ®Ø²ÙŠÙ†Ù‡ ÙƒÙ…ØªØºÙŠØ± Ø¨ÙŠØ¦Ø© (`process.env.JWT_SECRET`)**.
    * `options`: ÙƒØ§Ø¦Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©ØŒ Ø£Ù‡Ù…Ù‡Ø§ `expiresIn` Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ø¯Ø© ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªÙˆÙƒÙ† (Ù…Ø«Ù„ `'1h'`, `'7d'`).

**Ù…Ø«Ø§Ù„: Ù…Ø³Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„**
```javascript
const jwt = require('jsonwebtoken');

app.post('/login', (req, res) => {
  // 1. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (Ù‡Ù†Ø§ Ù…Ø«Ø§Ù„ ÙˆÙ‡Ù…ÙŠ)
  const { username, password } = req.body;
  if (username !== 'admin' || password !== 'password123') {
    return res.status(401).send('Invalid credentials');
  }

  // 2. Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©ØŒ Ø£Ù†Ø´Ø¦ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© (Payload)
  const userPayload = { id: 1, username: 'admin', role: 'administrator' };
  
  // 3. Ù‚Ù… Ø¨ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„ØªÙˆÙƒÙ†
  // ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠØŒ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ£ØªÙŠ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø³Ø±ÙŠ Ù…Ù† Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
  const accessToken = jwt.sign(userPayload, 'your_super_secret_key', { expiresIn: '1h' });

  // 4. Ø£Ø±Ø³Ù„ Ø§Ù„ØªÙˆÙƒÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù…ÙŠÙ„
  res.json({ accessToken: accessToken });
});
```

---
### ğŸ›¡ï¸ 3. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ† (Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª)
Ø§Ù„Ø¢Ù†ØŒ Ø³Ù†ÙƒØªØ¨ Middleware Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ† ÙÙŠ ÙƒÙ„ Ø·Ù„Ø¨ ÙŠØµÙ„ Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø± Ù…Ø­Ù…ÙŠ.

* **Ø¯Ø§Ù„Ø© `jwt.verify(token, secretKey, callback)`:**
    * ØªØ£Ø®Ø° Ø§Ù„ØªÙˆÙƒÙ† ÙˆØ§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø³Ø±ÙŠ.
    * ØªØ³ØªØ¯Ø¹ÙŠ Ø§Ù„Ù€ callback Ù…Ø¹ Ø®Ø·Ø£ (`err`) Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªÙˆÙƒÙ† ØºÙŠØ± ØµØ§Ù„Ø­ (ØªÙˆÙ‚ÙŠØ¹ Ø®Ø§Ø·Ø¦ØŒ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©ØŒ Ø¥Ù„Ø®)ØŒ Ø£Ùˆ Ù…Ø¹ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø§Ù„Ù…ÙÙƒÙƒØ© (`decodedPayload`) Ø¥Ø°Ø§ ÙƒØ§Ù† ØµØ§Ù„Ø­Ù‹Ø§.

**Ù…Ø«Ø§Ù„: Middleware Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø©**
```javascript
const authMiddleware = (req, res, next) => {
  // 1. Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ±ÙˆÙŠØ³Ø©
  const authHeader = req.headers['authorization'];
  
  // 2. Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ† (Ø¨Ø¹Ø¯ ÙƒÙ„Ù…Ø© "Bearer ")
  const token = authHeader && authHeader.split(' ')[1];

  // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ ØªÙˆÙƒÙ†ØŒ Ø£Ø±Ø³Ù„ Ø®Ø·Ø£
  if (token == null) return res.sendStatus(401); // Unauthorized

  // 3. ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ØªÙˆÙƒÙ†
  jwt.verify(token, 'your_super_secret_key', (err, user) => {
    if (err) return res.sendStatus(403); // Forbidden (invalid token)
    
    // 4. Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªÙˆÙƒÙ† ØµØ§Ù„Ø­Ù‹Ø§ØŒ Ø£Ø¶Ù Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø¥Ù„Ù‰ ÙƒØ§Ø¦Ù† Ø§Ù„Ø·Ù„Ø¨
    req.user = user;
    
    // 5. Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù€ Middleware Ø£Ùˆ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØªØ§Ù„ÙŠ
    next();
  });
};
```
---
### âš™ï¸ 4. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù€ Middleware Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª
Ø§Ù„Ø¢Ù† Ø¨Ø¨Ø³Ø§Ø·Ø© Ù†Ø¶Ø¹ `authMiddleware` Ù‚Ø¨Ù„ Ø£ÙŠ Ù…Ø¹Ø§Ù„Ø¬ Ù…Ø³Ø§Ø± Ù†Ø±ÙŠØ¯ Ø­Ù…Ø§ÙŠØªÙ‡.
```javascript
// Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø± Ù…Ø­Ù…ÙŠ Ø§Ù„Ø¢Ù†
app.get('/api/dashboard', authMiddleware, (req, res) => {
  // Ø¨ÙØ¶Ù„ Ø§Ù„Ù€ MiddlewareØŒ Ù†Ø­Ù† Ù†Ø¹Ø±Ù Ø£Ù† req.user Ù…ÙˆØ¬ÙˆØ¯ ÙˆØµØ§Ù„Ø­
  res.json({
    message: `Welcome to the dashboard, ${req.user.username}!`,
    userData: req.user
  });
});

// Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø± Ø¹Ø§Ù… ÙˆÙ…ØªØ§Ø­ Ù„Ù„Ø¬Ù…ÙŠØ¹
app.get('/', (req, res) => {
  res.send('This is the public homepage.');
});
```
---
