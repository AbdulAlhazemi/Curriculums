## ๐ ุงููุดุฑูุน ุงูููุงุฆู: ุฑุจุท ูุงุฌูุฉ API ุจูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL

### ๐ฏ ุงููุฏู
ุฅุนุงุฏุฉ ููููุฉ ูุดุฑูุน ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ุงูุฎุงุต ุจุงููุชุจ (ูู ุฏูุฑุฉ Express) ูุงุณุชุจุฏุงู ุชุฎุฒูู ุงูุจูุงูุงุช ูู ุงูุฐุงูุฑุฉ (ุงููุตูููุฉ) ุจูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL ุญููููุฉ. ุณูุซุจุช ูุฐุง ุงููุดุฑูุน ูุฏุฑุชู ุนูู ุชุตููู ูุฎุทุท ูุงุนุฏุฉ ุจูุงูุงุชุ ูุชุงุจุฉ ุงุณุชุนูุงูุงุช SQLุ ูุฑุจุท ุชุทุจูู Node.js ุจูุงุนุฏุฉ ุจูุงูุงุช ุนูุงุฆููุฉ.

---

### ๐ ุฃุฌุฒุงุก ุงููุดุฑูุน
ุงููุดุฑูุน ููุณู ุฅูู ุฌุฒุฃูู: ุงูุชูููุฐ ุจุงุณุชุฎุฏุงู SQL ุงูุฎุงู ุฃููุงูุ ุซู ุฅุนุงุฏุฉ ุงูููููุฉ ุงุฎุชูุงุฑููุง ุจุงุณุชุฎุฏุงู ORM.

---
### **ุงูุฌุฒุก ุงูุฃูู: ุงูุชูุงูู ุจุงุณุชุฎุฏุงู SQL ุงูุฎุงู ูููุชุจุฉ `pg`**
ูู ูุฐุง ุงูุฌุฒุกุ ุณูุชูุงุนู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจุงุดุฑุฉ ุจุงุณุชุฎุฏุงู ุงุณุชุนูุงูุงุช SQL.

#### **1. ุชุตููู ุงููุฎุทุท (Schema)**
ุณูุญุชุงุฌ ุฅูู ุฌุฏูููู: ูุงุญุฏ ูููุคูููู ูุงูุขุฎุฑ ูููุชุจุ ูุน ุนูุงูุฉ "ูุงุญุฏ ููุซูุฑ" ุจููููุง (ูุคูู ูุงุญุฏ ูู ุงูุนุฏูุฏ ูู ุงููุชุจ).
* **ุฌุฏูู `authors`:**
    * `id` (SERIAL, PRIMARY KEY)
    * `name` (VARCHAR, NOT NULL)
* **ุฌุฏูู `books`:**
    * `id` (SERIAL, PRIMARY KEY)
    * `title` (VARCHAR, NOT NULL)
    * `author_id` (INTEGER, FOREIGN KEY references `authors.id`)

#### **2. ุฅูุดุงุก ุงูุฌุฏุงูู (DDL)**
ุงุชุตู ุจูุงุนุฏุฉ ุจูุงูุงุชู ุจุงุณุชุฎุฏุงู `psql` ูููุฐ ุฃูุงูุฑ `CREATE TABLE` ุงูุชุงููุฉ:
```sql
CREATE TABLE authors (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL
);

CREATE TABLE books (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    author_id INTEGER,
    CONSTRAINT fk_author
        FOREIGN KEY(author_id) 
        REFERENCES authors(id)
        ON DELETE SET NULL -- Or ON DELETE CASCADE
);
```

#### **3. ุชุนุฏูู ุงููุชุญููุงุช (Controllers)**
ูุฐุง ูู ุงูุฌุฒุก ุงูุจุฑูุฌู ุงูุฃุณุงุณู. ุณุชุญุชุงุฌ ุฅูู ุชุนุฏูู ุฏูุงู ุงูู controller ุงูุฎุงุตุฉ ุจู ูุงุณุชุจุฏุงู ููุทู ุงูุชุนุงูู ูุน ุงููุตูููุฉ ุจููุทู `pool.query()` ููุชูุงุนู ูุน PostgreSQL.

* **`getAllBooks`:** ุณุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู `INNER JOIN` ูุฌูุจ ุนููุงู ุงููุชุงุจ ูุงุณู ุงููุคูู ูุนูุง.
* **`getBookById`:** ุณุชุญุชุงุฌ ุฃูุถูุง ุฅูู `JOIN` ูุงุณุชุฎุฏุงู ุงุณุชุนูุงู ููููุนูู (parameterized query) ูุน `WHERE id = $1`.
* **`createBook`:** ุณุชุฃุฎุฐ `title` ู `author_id` ูู `req.body` ูุชุณุชุฎุฏู `INSERT INTO`.
* **`updateBook`:** ุณุชุณุชุฎุฏู `UPDATE ... WHERE id = $1`.
* **`deleteBook`:** ุณุชุณุชุฎุฏู `DELETE FROM ... WHERE id = $1`.

---
### **ุงูุฌุฒุก ุงูุซุงูู (ุงุฎุชูุงุฑู): ุฅุนุงุฏุฉ ุงูููููุฉ ุจุงุณุชุฎุฏุงู ORM - Sequelize**
ูุฐุง ุงูุฌุฒุก ููุถุญ ููู ูููู ูู ORM ุชุจุณูุท ุงูููุฏ.

**1. ุฅุนุฏุงุฏ Sequelize:**
* ูู ุจุชุซุจูุช `sequelize`, `pg`, `pg-hstore`.
* ุฃูุดุฆ ููู ุงุชุตุงู `sequelize.js`.
* ุนุฑูู ููุฏูู `Author` ูููุฏูู `Book`.
* ุนุฑูู ุงูุนูุงูุฉ ุจููููุง: `Author.hasMany(Book)` ู `Book.belongsTo(Author)`.

**2. ุฅุนุงุฏุฉ ูุชุงุจุฉ ุงููุชุญููุงุช:**
* ุงุณุชุจุฏู ูู ุงุณุชุฏุนุงุก `pool.query(...)` ุจุฏูุงู Sequelize ุงูููุงุจูุฉ.
* **ูุซุงู (ูุฌูุจ ุฌููุน ุงููุชุจ ูุน ูุคููููุง):**
    ```javascript
    // ุจุฏูุงู ูู ูุชุงุจุฉ JOIN ูุฏูููุง
    const books = await Book.findAll({
      include: Author // Sequelize ุณูููู ุจุงูู JOIN ุชููุงุฆููุง
    });
    res.json(books);
    ```

---
### โ ูุนุงููุฑ ุงูุชูููู
* ูุฎุทุท ูุงุนุฏุฉ ุจูุงูุงุช ุตุญูุญ ูููุธู.
* ูุงุฌูุฉ API ุชุนูู ุจุดูู ูุงูู ุญูุซ ุชููู ุนูููุงุช CRUD ุจุงูุชูุงุนู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ.
* ุงูุงุณุชุฎุฏุงู ุงูุตุญูุญ ููุงุณุชุนูุงูุงุช ุงูููููุนูููุฉ ูู ุงูุฌุฒุก ุงูุฃูู ูููุน ุญูู SQL.
* (ุงุฎุชูุงุฑู) ุฅุนุงุฏุฉ ููููุฉ ูุงุฌุญุฉ ุจุงุณุชุฎุฏุงู Sequelizeุ ููุง ูุฏู ุนูู ููู ููุงููู ุงูู ORM.

---
### ๐ ุงูุฎุทูุฉ ุงูุฃููู
1.  ุงุจุฏุฃ ุจุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ุฌุฏูุฏุฉ ููุดุฑูุนู (e.g., `CREATE DATABASE book_api;`).
2.  ุจุงุณุชุฎุฏุงู `psql`ุ ุงุชุตู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ ูููุฐ ุฃูุงูุฑ `CREATE TABLE` ูุฅูุดุงุก ุฌุฏููู `authors` ู `books`.
3.  ุงุจุฏุฃ ุจุชุนุฏูู ุฃูู ููุทุฉ ููุงูุฉ ูู ุงูู controllerุ ููู `getAllBooks`ุ ูุฌูุจ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู `JOIN`.

ุฃุชููู ูู ูู ุงูุชูููู ูู ูุดุฑูุนู ุงูููุงุฆู!